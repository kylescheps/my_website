<!DOCTYPE HTML>
<html>

    <head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<meta name="description" content="Kyle">
	<meta name="author" content="Kyle">
	<meta name="generator" content="Hugo 0.75.1" />
	<title>GDP components over time and among countries &middot; Kyle S</title>
	<!-- Stylesheets -->
	
	<link rel="stylesheet" href="/css/main.css"/>
	
	

	

	<!-- Custom Fonts -->
	<link href="/css/font-awesome.min.css" rel="stylesheet" type="text/css">

	
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
	<link rel="icon" type="image/x-icon" href="/favicon.ico">
	

	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
	<script src="js/ie/html5shiv.js"></script>
	<script src="js/ie/html5shiv.jsrespond.min.js"></script>
	<![endif]-->
</head>

    <body>

    <!-- Wrapper -->
        <div id="wrapper">

            <!-- Header -->
    <header id="header" class="alt">
        <a href="/" class="logo"><strong>My website</strong> <span></span></a>
        <nav>
            <a href="#menu">Menu</a>
        </nav>
    </header>

<!-- Menu -->
    <nav id="menu">
        <ul class="links">
            
                <li><a href="/">Home</a></li>
            
                <li><a href="/projects">Projects</a></li>
            

        </ul>
        <ul class="actions vertical">
            
            
        </ul>
    </nav>

        <!-- Main -->
            <div id="main" class="alt">

                
                    <section id="one">
                        <div class="inner">
                            <header class="major">
                                <h1>GDP components over time and among countries</h1>
                            </header>
                            
                                <span class="image main"><img src="/img/Projects/GDP.jpg" alt="" /></span>
                            
                            
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>At the risk of oversimplifying things, the main components of gross domestic product, GDP are personal consumption (C), business investment (I), government spending (G) and net exports (exports - imports). You can read more about GDP and the different approaches in calculating at the <a href="https://en.wikipedia.org/wiki/Gross_domestic_product">Wikipedia GDP page</a>.</p>
<p>The GDP data we will look at is from the <a href="https://unstats.un.org/unsd/snaama/Downloads">United Nations’ National Accounts Main Aggregates Database</a>, which contains estimates of total GDP and its components for all countries from 1970 to today. We will look at how GDP and its components have changed over time, and compare different countries and how much each component contributes to that country’s GDP. The file we will work with is <a href="http://unstats.un.org/unsd/amaapi/api/file/6">GDP and its breakdown at constant 2010 prices in US Dollars</a></p>
<p>We first load the file</p>
<pre class="r"><code>UN_GDP_data  &lt;-  read_excel(here::here(&quot;Data&quot;,&quot;Download-GDPconstant-USD-countries.xls&quot;), # Excel filename
                sheet=&quot;Download-GDPconstant-USD-countr&quot;, # Sheet name
                skip=2) # Number of rows to skip</code></pre>
<p>Then, we tidy the data. As it is in wide format, we make it into long, tidy format.</p>
<pre class="r"><code>UN_GDP_data</code></pre>
<pre><code>## # A tibble: 3,685 x 51
##    CountryID Country IndicatorName  `1970`  `1971` `1972` `1973` `1974`  `1975`
##        &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1         4 Afghan… Final consum… 5.56e 9 5.33e 9 5.20e9 5.75e9 6.15e9 6.32e 9
##  2         4 Afghan… Household co… 5.07e 9 4.84e 9 4.70e9 5.21e9 5.59e9 5.65e 9
##  3         4 Afghan… General gove… 3.72e 8 3.82e 8 4.02e8 4.21e8 4.31e8 5.98e 8
##  4         4 Afghan… Gross capita… 9.85e 8 1.05e 9 9.19e8 9.19e8 1.18e9 1.37e 9
##  5         4 Afghan… Gross fixed … 9.85e 8 1.05e 9 9.19e8 9.19e8 1.18e9 1.37e 9
##  6         4 Afghan… Exports of g… 1.12e 8 1.45e 8 1.73e8 2.18e8 3.00e8 3.16e 8
##  7         4 Afghan… Imports of g… 1.84e 8 2.69e 8 2.60e8 2.78e8 4.07e8 4.59e 8
##  8         4 Afghan… Gross Domest… 1.07e10 1.07e10 8.94e9 9.20e9 9.70e9 1.03e10
##  9         4 Afghan… Agriculture,… 7.99e 9 7.68e 9 7.36e9 7.90e9 8.18e9 8.45e 9
## 10         4 Afghan… Mining, Manu… 1.01e 9 1.05e 9 1.10e9 1.15e9 1.27e9 1.39e 9
## # … with 3,675 more rows, and 42 more variables: `1976` &lt;dbl&gt;, `1977` &lt;dbl&gt;,
## #   `1978` &lt;dbl&gt;, `1979` &lt;dbl&gt;, `1980` &lt;dbl&gt;, `1981` &lt;dbl&gt;, `1982` &lt;dbl&gt;,
## #   `1983` &lt;dbl&gt;, `1984` &lt;dbl&gt;, `1985` &lt;dbl&gt;, `1986` &lt;dbl&gt;, `1987` &lt;dbl&gt;,
## #   `1988` &lt;dbl&gt;, `1989` &lt;dbl&gt;, `1990` &lt;dbl&gt;, `1991` &lt;dbl&gt;, `1992` &lt;dbl&gt;,
## #   `1993` &lt;dbl&gt;, `1994` &lt;dbl&gt;, `1995` &lt;dbl&gt;, `1996` &lt;dbl&gt;, `1997` &lt;dbl&gt;,
## #   `1998` &lt;dbl&gt;, `1999` &lt;dbl&gt;, `2000` &lt;dbl&gt;, `2001` &lt;dbl&gt;, `2002` &lt;dbl&gt;,
## #   `2003` &lt;dbl&gt;, `2004` &lt;dbl&gt;, `2005` &lt;dbl&gt;, `2006` &lt;dbl&gt;, `2007` &lt;dbl&gt;,
## #   `2008` &lt;dbl&gt;, `2009` &lt;dbl&gt;, `2010` &lt;dbl&gt;, `2011` &lt;dbl&gt;, `2012` &lt;dbl&gt;,
## #   `2013` &lt;dbl&gt;, `2014` &lt;dbl&gt;, `2015` &lt;dbl&gt;, `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;</code></pre>
<pre class="r"><code>skim(UN_GDP_data)</code></pre>
<table>
<caption>(#tab:reshape_GDP_data)Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">UN_GDP_data</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">3685</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">51</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">49</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Country</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">34</td>
<td align="right">0</td>
<td align="right">220</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">IndicatorName</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">17</td>
<td align="right">88</td>
<td align="right">0</td>
<td align="right">17</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<colgroup>
<col width="12%" />
<col width="9%" />
<col width="12%" />
<col width="8%" />
<col width="8%" />
<col width="9%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CountryID</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">4.39e+02</td>
<td align="right">2.54e+02</td>
<td align="right">4.00e+00</td>
<td align="right">2.14e+02</td>
<td align="right">4.40e+02</td>
<td align="right">6.60e+02</td>
<td align="right">8.94e+02</td>
<td align="left">▇▇▇▇▆</td>
</tr>
<tr class="even">
<td align="left">1970</td>
<td align="right">572</td>
<td align="right">0.84</td>
<td align="right">3.28e+10</td>
<td align="right">2.03e+11</td>
<td align="right">-5.68e+11</td>
<td align="right">1.47e+08</td>
<td align="right">1.03e+09</td>
<td align="right">7.60e+09</td>
<td align="right">5.51e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">1971</td>
<td align="right">573</td>
<td align="right">0.84</td>
<td align="right">3.43e+10</td>
<td align="right">2.09e+11</td>
<td align="right">-3.66e+11</td>
<td align="right">1.53e+08</td>
<td align="right">1.10e+09</td>
<td align="right">8.17e+09</td>
<td align="right">5.60e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">1972</td>
<td align="right">574</td>
<td align="right">0.84</td>
<td align="right">3.63e+10</td>
<td align="right">2.20e+11</td>
<td align="right">-3.88e+11</td>
<td align="right">1.57e+08</td>
<td align="right">1.13e+09</td>
<td align="right">8.68e+09</td>
<td align="right">5.87e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">1973</td>
<td align="right">573</td>
<td align="right">0.84</td>
<td align="right">3.87e+10</td>
<td align="right">2.32e+11</td>
<td align="right">-4.53e+11</td>
<td align="right">1.67e+08</td>
<td align="right">1.17e+09</td>
<td align="right">9.19e+09</td>
<td align="right">6.16e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">1974</td>
<td align="right">573</td>
<td align="right">0.84</td>
<td align="right">3.96e+10</td>
<td align="right">2.33e+11</td>
<td align="right">-5.66e+11</td>
<td align="right">1.79e+08</td>
<td align="right">1.32e+09</td>
<td align="right">1.00e+10</td>
<td align="right">6.17e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">1975</td>
<td align="right">574</td>
<td align="right">0.84</td>
<td align="right">4.00e+10</td>
<td align="right">2.34e+11</td>
<td align="right">-2.50e+11</td>
<td align="right">1.78e+08</td>
<td align="right">1.32e+09</td>
<td align="right">1.04e+10</td>
<td align="right">6.10e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">1976</td>
<td align="right">574</td>
<td align="right">0.84</td>
<td align="right">4.21e+10</td>
<td align="right">2.45e+11</td>
<td align="right">-3.08e+11</td>
<td align="right">1.90e+08</td>
<td align="right">1.38e+09</td>
<td align="right">1.09e+10</td>
<td align="right">6.36e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">1977</td>
<td align="right">574</td>
<td align="right">0.84</td>
<td align="right">4.38e+10</td>
<td align="right">2.55e+11</td>
<td align="right">-3.30e+11</td>
<td align="right">1.99e+08</td>
<td align="right">1.46e+09</td>
<td align="right">1.16e+10</td>
<td align="right">6.64e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">1978</td>
<td align="right">572</td>
<td align="right">0.84</td>
<td align="right">4.56e+10</td>
<td align="right">2.67e+11</td>
<td align="right">-3.26e+11</td>
<td align="right">2.08e+08</td>
<td align="right">1.50e+09</td>
<td align="right">1.19e+10</td>
<td align="right">6.96e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">1979</td>
<td align="right">573</td>
<td align="right">0.84</td>
<td align="right">4.74e+10</td>
<td align="right">2.76e+11</td>
<td align="right">-3.84e+11</td>
<td align="right">2.17e+08</td>
<td align="right">1.60e+09</td>
<td align="right">1.27e+10</td>
<td align="right">7.14e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">1980</td>
<td align="right">571</td>
<td align="right">0.85</td>
<td align="right">4.83e+10</td>
<td align="right">2.78e+11</td>
<td align="right">-3.39e+11</td>
<td align="right">2.29e+08</td>
<td align="right">1.61e+09</td>
<td align="right">1.29e+10</td>
<td align="right">7.15e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">1981</td>
<td align="right">568</td>
<td align="right">0.85</td>
<td align="right">4.90e+10</td>
<td align="right">2.83e+11</td>
<td align="right">-3.33e+11</td>
<td align="right">2.33e+08</td>
<td align="right">1.64e+09</td>
<td align="right">1.35e+10</td>
<td align="right">7.26e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">1982</td>
<td align="right">568</td>
<td align="right">0.85</td>
<td align="right">4.93e+10</td>
<td align="right">2.85e+11</td>
<td align="right">-2.79e+11</td>
<td align="right">2.32e+08</td>
<td align="right">1.63e+09</td>
<td align="right">1.36e+10</td>
<td align="right">7.26e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">1983</td>
<td align="right">568</td>
<td align="right">0.85</td>
<td align="right">5.06e+10</td>
<td align="right">2.94e+11</td>
<td align="right">-4.06e+10</td>
<td align="right">2.35e+08</td>
<td align="right">1.65e+09</td>
<td align="right">1.39e+10</td>
<td align="right">7.43e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">1984</td>
<td align="right">568</td>
<td align="right">0.85</td>
<td align="right">5.28e+10</td>
<td align="right">3.09e+11</td>
<td align="right">-4.38e+10</td>
<td align="right">2.47e+08</td>
<td align="right">1.72e+09</td>
<td align="right">1.45e+10</td>
<td align="right">7.91e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">1985</td>
<td align="right">567</td>
<td align="right">0.85</td>
<td align="right">5.45e+10</td>
<td align="right">3.22e+11</td>
<td align="right">-8.74e+10</td>
<td align="right">2.58e+08</td>
<td align="right">1.77e+09</td>
<td align="right">1.46e+10</td>
<td align="right">8.20e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">1986</td>
<td align="right">567</td>
<td align="right">0.85</td>
<td align="right">5.64e+10</td>
<td align="right">3.33e+11</td>
<td align="right">-3.50e+10</td>
<td align="right">2.74e+08</td>
<td align="right">1.80e+09</td>
<td align="right">1.50e+10</td>
<td align="right">8.47e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">1987</td>
<td align="right">566</td>
<td align="right">0.85</td>
<td align="right">5.85e+10</td>
<td align="right">3.45e+11</td>
<td align="right">-2.70e+10</td>
<td align="right">2.77e+08</td>
<td align="right">1.83e+09</td>
<td align="right">1.55e+10</td>
<td align="right">8.77e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">1988</td>
<td align="right">565</td>
<td align="right">0.85</td>
<td align="right">6.12e+10</td>
<td align="right">3.60e+11</td>
<td align="right">-3.60e+10</td>
<td align="right">2.86e+08</td>
<td align="right">1.92e+09</td>
<td align="right">1.56e+10</td>
<td align="right">9.19e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">1989</td>
<td align="right">547</td>
<td align="right">0.85</td>
<td align="right">6.30e+10</td>
<td align="right">3.71e+11</td>
<td align="right">-2.98e+10</td>
<td align="right">3.02e+08</td>
<td align="right">1.95e+09</td>
<td align="right">1.59e+10</td>
<td align="right">9.41e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">1990</td>
<td align="right">80</td>
<td align="right">0.98</td>
<td align="right">6.01e+10</td>
<td align="right">3.58e+11</td>
<td align="right">-3.53e+10</td>
<td align="right">3.63e+08</td>
<td align="right">2.27e+09</td>
<td align="right">1.57e+10</td>
<td align="right">9.57e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">1991</td>
<td align="right">161</td>
<td align="right">0.96</td>
<td align="right">5.89e+10</td>
<td align="right">3.61e+11</td>
<td align="right">-3.21e+10</td>
<td align="right">3.51e+08</td>
<td align="right">2.17e+09</td>
<td align="right">1.43e+10</td>
<td align="right">9.56e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">1992</td>
<td align="right">160</td>
<td align="right">0.96</td>
<td align="right">6.00e+10</td>
<td align="right">3.70e+11</td>
<td align="right">-2.99e+10</td>
<td align="right">3.48e+08</td>
<td align="right">2.14e+09</td>
<td align="right">1.47e+10</td>
<td align="right">9.76e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">1993</td>
<td align="right">160</td>
<td align="right">0.96</td>
<td align="right">6.07e+10</td>
<td align="right">3.76e+11</td>
<td align="right">-4.93e+10</td>
<td align="right">3.35e+08</td>
<td align="right">2.06e+09</td>
<td align="right">1.47e+10</td>
<td align="right">9.96e+12</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">1994</td>
<td align="right">177</td>
<td align="right">0.95</td>
<td align="right">6.29e+10</td>
<td align="right">3.89e+11</td>
<td align="right">-5.84e+10</td>
<td align="right">3.55e+08</td>
<td align="right">2.11e+09</td>
<td align="right">1.52e+10</td>
<td align="right">1.03e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">1995</td>
<td align="right">170</td>
<td align="right">0.95</td>
<td align="right">6.50e+10</td>
<td align="right">3.99e+11</td>
<td align="right">-1.96e+11</td>
<td align="right">3.82e+08</td>
<td align="right">2.22e+09</td>
<td align="right">1.56e+10</td>
<td align="right">1.06e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">1996</td>
<td align="right">169</td>
<td align="right">0.95</td>
<td align="right">6.72e+10</td>
<td align="right">4.12e+11</td>
<td align="right">-2.55e+11</td>
<td align="right">4.00e+08</td>
<td align="right">2.26e+09</td>
<td align="right">1.63e+10</td>
<td align="right">1.10e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">1997</td>
<td align="right">170</td>
<td align="right">0.95</td>
<td align="right">6.99e+10</td>
<td align="right">4.27e+11</td>
<td align="right">-2.86e+11</td>
<td align="right">4.23e+08</td>
<td align="right">2.42e+09</td>
<td align="right">1.73e+10</td>
<td align="right">1.15e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">1998</td>
<td align="right">173</td>
<td align="right">0.95</td>
<td align="right">7.17e+10</td>
<td align="right">4.42e+11</td>
<td align="right">-1.91e+11</td>
<td align="right">4.51e+08</td>
<td align="right">2.64e+09</td>
<td align="right">1.74e+10</td>
<td align="right">1.19e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">1999</td>
<td align="right">173</td>
<td align="right">0.95</td>
<td align="right">7.43e+10</td>
<td align="right">4.59e+11</td>
<td align="right">-2.53e+10</td>
<td align="right">4.45e+08</td>
<td align="right">2.60e+09</td>
<td align="right">1.80e+10</td>
<td align="right">1.24e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">2000</td>
<td align="right">171</td>
<td align="right">0.95</td>
<td align="right">7.77e+10</td>
<td align="right">4.77e+11</td>
<td align="right">-1.26e+10</td>
<td align="right">4.73e+08</td>
<td align="right">2.75e+09</td>
<td align="right">1.90e+10</td>
<td align="right">1.29e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">2001</td>
<td align="right">171</td>
<td align="right">0.95</td>
<td align="right">7.92e+10</td>
<td align="right">4.84e+11</td>
<td align="right">-4.94e+10</td>
<td align="right">4.95e+08</td>
<td align="right">2.88e+09</td>
<td align="right">1.97e+10</td>
<td align="right">1.30e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">2002</td>
<td align="right">170</td>
<td align="right">0.95</td>
<td align="right">8.09e+10</td>
<td align="right">4.93e+11</td>
<td align="right">-2.82e+10</td>
<td align="right">5.30e+08</td>
<td align="right">3.04e+09</td>
<td align="right">2.01e+10</td>
<td align="right">1.32e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">2003</td>
<td align="right">172</td>
<td align="right">0.95</td>
<td align="right">8.35e+10</td>
<td align="right">5.06e+11</td>
<td align="right">-2.52e+10</td>
<td align="right">5.37e+08</td>
<td align="right">3.18e+09</td>
<td align="right">2.15e+10</td>
<td align="right">1.36e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">2004</td>
<td align="right">169</td>
<td align="right">0.95</td>
<td align="right">8.75e+10</td>
<td align="right">5.24e+11</td>
<td align="right">-1.89e+11</td>
<td align="right">6.03e+08</td>
<td align="right">3.40e+09</td>
<td align="right">2.28e+10</td>
<td align="right">1.40e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">2005</td>
<td align="right">133</td>
<td align="right">0.96</td>
<td align="right">9.06e+10</td>
<td align="right">5.39e+11</td>
<td align="right">-1.08e+11</td>
<td align="right">6.13e+08</td>
<td align="right">3.52e+09</td>
<td align="right">2.42e+10</td>
<td align="right">1.45e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">2006</td>
<td align="right">131</td>
<td align="right">0.96</td>
<td align="right">9.49e+10</td>
<td align="right">5.56e+11</td>
<td align="right">-5.09e+10</td>
<td align="right">6.53e+08</td>
<td align="right">3.77e+09</td>
<td align="right">2.59e+10</td>
<td align="right">1.49e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">2007</td>
<td align="right">131</td>
<td align="right">0.96</td>
<td align="right">9.92e+10</td>
<td align="right">5.70e+11</td>
<td align="right">-2.13e+11</td>
<td align="right">7.05e+08</td>
<td align="right">4.06e+09</td>
<td align="right">2.74e+10</td>
<td align="right">1.51e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">2008</td>
<td align="right">96</td>
<td align="right">0.97</td>
<td align="right">1.00e+11</td>
<td align="right">5.71e+11</td>
<td align="right">-3.26e+11</td>
<td align="right">7.44e+08</td>
<td align="right">4.29e+09</td>
<td align="right">2.88e+10</td>
<td align="right">1.51e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">2009</td>
<td align="right">96</td>
<td align="right">0.97</td>
<td align="right">9.77e+10</td>
<td align="right">5.62e+11</td>
<td align="right">-1.64e+11</td>
<td align="right">6.62e+08</td>
<td align="right">4.15e+09</td>
<td align="right">2.83e+10</td>
<td align="right">1.47e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">2010</td>
<td align="right">96</td>
<td align="right">0.97</td>
<td align="right">1.03e+11</td>
<td align="right">5.80e+11</td>
<td align="right">-5.11e+09</td>
<td align="right">7.39e+08</td>
<td align="right">4.40e+09</td>
<td align="right">2.96e+10</td>
<td align="right">1.50e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">2011</td>
<td align="right">114</td>
<td align="right">0.97</td>
<td align="right">1.07e+11</td>
<td align="right">5.96e+11</td>
<td align="right">-9.68e+10</td>
<td align="right">7.69e+08</td>
<td align="right">4.60e+09</td>
<td align="right">3.07e+10</td>
<td align="right">1.52e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">2012</td>
<td align="right">114</td>
<td align="right">0.97</td>
<td align="right">1.09e+11</td>
<td align="right">6.10e+11</td>
<td align="right">-1.19e+11</td>
<td align="right">7.56e+08</td>
<td align="right">4.76e+09</td>
<td align="right">3.16e+10</td>
<td align="right">1.56e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">2013</td>
<td align="right">131</td>
<td align="right">0.96</td>
<td align="right">1.13e+11</td>
<td align="right">6.26e+11</td>
<td align="right">-1.93e+10</td>
<td align="right">7.91e+08</td>
<td align="right">5.14e+09</td>
<td align="right">3.36e+10</td>
<td align="right">1.59e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">2014</td>
<td align="right">133</td>
<td align="right">0.96</td>
<td align="right">1.16e+11</td>
<td align="right">6.45e+11</td>
<td align="right">-2.45e+10</td>
<td align="right">8.16e+08</td>
<td align="right">5.34e+09</td>
<td align="right">3.38e+10</td>
<td align="right">1.62e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">2015</td>
<td align="right">134</td>
<td align="right">0.96</td>
<td align="right">1.19e+11</td>
<td align="right">6.66e+11</td>
<td align="right">-1.18e+11</td>
<td align="right">8.35e+08</td>
<td align="right">5.36e+09</td>
<td align="right">3.46e+10</td>
<td align="right">1.67e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">2016</td>
<td align="right">136</td>
<td align="right">0.96</td>
<td align="right">1.22e+11</td>
<td align="right">6.84e+11</td>
<td align="right">-2.95e+10</td>
<td align="right">8.56e+08</td>
<td align="right">5.49e+09</td>
<td align="right">3.50e+10</td>
<td align="right">1.70e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">2017</td>
<td align="right">143</td>
<td align="right">0.96</td>
<td align="right">1.27e+11</td>
<td align="right">7.05e+11</td>
<td align="right">-2.81e+10</td>
<td align="right">8.77e+08</td>
<td align="right">5.69e+09</td>
<td align="right">3.66e+10</td>
<td align="right">1.73e+13</td>
<td align="left">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
<pre class="r"><code>tidy_GDP_data  &lt;- UN_GDP_data %&gt;%
                  pivot_longer(cols=4:51,names_to=&quot;Year&quot;,values_to = &quot;Expenditure&quot;) %&gt;%
                  mutate (Expenditure = Expenditure / 1000000000 ) %&gt;%
                  mutate(
                        IndicatorName = case_when(
                        IndicatorName == &quot;Final consumption expenditure&quot; ~ &quot;FCI&quot;,
                        IndicatorName == &quot;Household consumption expenditure (including Non-profit institutions serving households)&quot; ~ &quot;Household Expenditure&quot;,
                        IndicatorName == &quot;General government final consumption expenditure&quot; ~ &quot;Government Expenditure&quot;,
                        IndicatorName == &quot;Gross capital formation&quot; ~ &quot;Gross capital formation&quot;,
                        IndicatorName == &quot;Gross fixed capital formation (including Acquisitions less disposals of valuables)&quot; ~ &quot;GFCF&quot;,
                        IndicatorName == &quot;Exports of goods and services&quot; ~ &quot;Exports&quot;,
                        IndicatorName == &quot;Imports of goods and services&quot; ~ &quot;Imports&quot;,
                        IndicatorName == &quot;Gross Domestic Product (GDP)&quot; ~ &quot;GDP&quot;,
                        IndicatorName == &quot;Agriculture, hunting, forestry, fishing (ISIC A-B)&quot; ~ &quot;AHFF&quot;,
                        IndicatorName == &quot;Mining, Manufacturing, Utilities (ISIC C-E)&quot; ~ &quot;MMU&quot;,
                        IndicatorName == &quot;Manufacturing (ISIC D)&quot; ~ &quot;M&quot;,
                        IndicatorName == &quot;Construction (ISIC F)&quot; ~ &quot;C&quot;,
                        IndicatorName == &quot;Wholesale, retail trade, restaurants and hotels (ISIC G-H)&quot; ~ &quot;WRRH&quot;,
                        IndicatorName == &quot;Transport, storage and communication (ISIC I)&quot; ~ &quot;TSC&quot;,
                        IndicatorName == &quot;Other Activities (ISIC J-P)&quot; ~ &quot;OA&quot;,
                        IndicatorName == &quot;Total Value Added&quot; ~ &quot;TVA&quot;))
     

tidy_GDP_data</code></pre>
<pre><code>## # A tibble: 176,880 x 5
##    CountryID Country     IndicatorName Year  Expenditure
##        &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt;       &lt;dbl&gt;
##  1         4 Afghanistan FCI           1970         5.56
##  2         4 Afghanistan FCI           1971         5.33
##  3         4 Afghanistan FCI           1972         5.20
##  4         4 Afghanistan FCI           1973         5.75
##  5         4 Afghanistan FCI           1974         6.15
##  6         4 Afghanistan FCI           1975         6.32
##  7         4 Afghanistan FCI           1976         6.37
##  8         4 Afghanistan FCI           1977         6.90
##  9         4 Afghanistan FCI           1978         7.09
## 10         4 Afghanistan FCI           1979         6.92
## # … with 176,870 more rows</code></pre>
<pre class="r"><code># Let us compare GDP components for these 3 countries
country_list &lt;- c(&quot;United States&quot;,&quot;India&quot;, &quot;Germany&quot;)</code></pre>
<p>We now produce the following plot:</p>
<pre class="r"><code>country_list</code></pre>
<pre><code>## [1] &quot;United States&quot; &quot;India&quot;         &quot;Germany&quot;</code></pre>
<pre class="r"><code>#cleaning data
tidy_GDP_data2 &lt;- tidy_GDP_data %&gt;%
                    group_by(Year) %&gt;%
                    select(Country, 
                           Year, 
                           IndicatorName, 
                           Expenditure) %&gt;%
                    filter(Country == &quot;Germany&quot; | Country == &quot;India&quot; | Country == &quot;United States&quot;) %&gt;%
                    filter(IndicatorName %in% c(&quot;Exports&quot;,
                                                &quot;Imports&quot;,
                                                &quot;Gross capital formation&quot;,
                                                &quot;Government Expenditure&quot;,
                                                &quot;Household Expenditure&quot;)) 
tidy_GDP_data2</code></pre>
<pre><code>## # A tibble: 720 x 4
## # Groups:   Year [48]
##    Country Year  IndicatorName         Expenditure
##    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;                       &lt;dbl&gt;
##  1 Germany 1970  Household Expenditure        872.
##  2 Germany 1971  Household Expenditure        919.
##  3 Germany 1972  Household Expenditure        969.
##  4 Germany 1973  Household Expenditure        997.
##  5 Germany 1974  Household Expenditure        995.
##  6 Germany 1975  Household Expenditure       1032.
##  7 Germany 1976  Household Expenditure       1076.
##  8 Germany 1977  Household Expenditure       1122.
##  9 Germany 1978  Household Expenditure       1162.
## 10 Germany 1979  Household Expenditure       1200.
## # … with 710 more rows</code></pre>
<pre class="r"><code>#plotting a graph
ggplot(tidy_GDP_data2, 
        aes (x = Year, 
             y = Expenditure, 
             color = IndicatorName, 
             group = IndicatorName)
        ) + 
  geom_line()+
  labs(y = &quot;Billion US$&quot;, 
        title = &quot;GDP components over time&quot;, 
        subtitle = &quot;In Constant USD 2010&quot;, x =&quot;&quot;, 
        legend = &quot;Components of GDP&quot;,
        IndicatorName = &quot;Components of GDP&quot;
        ) +             
  facet_wrap(~ Country) +
  scale_x_discrete(breaks = c(1970,1980,1990,2000,2010,2020)) +
  guides(color=guide_legend(&quot;Components of GDP&quot;)) +
  theme_wsj() +
    #customise our graph
  theme(
    panel.spacing = unit(2, &quot;lines&quot;),
    plot.title = element_text(size = 18),
    plot.subtitle = element_text(size=13),
    axis.title.y=element_text(size=13),
    axis.text.x = element_text(size = 9),
    axis.text.y = element_text(size = 10),
    plot.caption = element_text(size = 10),
    legend.title = element_blank(), 
    legend.text = element_text(size = 11),
    strip.text = element_text(size=13)
    ) </code></pre>
<p><img src="/Projects/2020-10-20-project-3_files/figure-html/gdp1-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p><strong>If you want to, please change <code>country_list &lt;- c("United States","India", "Germany")</code> to include your own country and compare it with any two other countries you like</strong></p>
<p>We plot a graph for Canada, Mexico and the United States.</p>
<pre class="r"><code>#plotting a graph for Canada, Mexico, and United States

country_list2 &lt;-c(&quot;United States&quot;,&quot;India&quot;, &quot;Germany&quot;)


tidy_GDP_data4 &lt;- tidy_GDP_data %&gt;%
                    group_by(Year) %&gt;%
                    select(Country, Year, IndicatorName, Expenditure) %&gt;%
                    filter(Country == &quot;Canada&quot; | Country == &quot;Mexico&quot; | Country == &quot;United States&quot;) %&gt;%
                    filter(IndicatorName %in% c(&quot;Exports&quot;, &quot;Imports&quot;, &quot;Gross capital formation&quot;, &quot;Government Expenditure&quot;, &quot;Household Expenditure&quot; ))
                    
                    

tidy_GDP_data4</code></pre>
<pre><code>## # A tibble: 720 x 4
## # Groups:   Year [48]
##    Country Year  IndicatorName         Expenditure
##    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;                       &lt;dbl&gt;
##  1 Canada  1970  Household Expenditure        266.
##  2 Canada  1971  Household Expenditure        282.
##  3 Canada  1972  Household Expenditure        301.
##  4 Canada  1973  Household Expenditure        321.
##  5 Canada  1974  Household Expenditure        338.
##  6 Canada  1975  Household Expenditure        350.
##  7 Canada  1976  Household Expenditure        368.
##  8 Canada  1977  Household Expenditure        379.
##  9 Canada  1978  Household Expenditure        390.
## 10 Canada  1979  Household Expenditure        399.
## # … with 710 more rows</code></pre>
<pre class="r"><code>ggplot(tidy_GDP_data4, 
       aes(x = Year, 
           y = Expenditure, 
           color = IndicatorName, 
           group = IndicatorName)
       ) + 
        geom_line()+
  labs(y = &quot;Billion US$&quot;, 
       title = &quot;GDP components over time&quot;, 
       subtitle = &quot;In Constant USD 2010&quot;
       ) +           
  facet_wrap(~ Country) +
  scale_x_discrete(breaks = c(1970,1980,1990,2000,2010,2020))+
  guides(color=guide_legend(&quot;Components of GDP&quot;)) +
  theme_wsj(base_size = 6) +
  theme(
    panel.spacing = unit(2, &quot;lines&quot;),
    plot.title = element_text(size = 18),
    plot.subtitle = element_text(size=13),
    axis.title.y=element_text(size=13),
    axis.text.x = element_text(size = 9),
    axis.text.y = element_text(size = 10),
    plot.caption = element_text(size = 10),
    legend.title = element_blank(), 
    legend.text = element_text(size = 11),
    strip.text = element_text(size=13)
    ) </code></pre>
<p><img src="/Projects/2020-10-20-project-3_files/figure-html/gdp2-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>Using the <a href="https://www.investopedia.com/terms/e/expenditure-method.asp">Expenditure method</a> equation for GDP = Household Expenditure (Consumption <em>C</em>) + Gross Capital Formation (business investment <em>I</em>) + Government Expenditure (G) + Net Exports (exports - imports), we can calculate the GDP from the individual indicators in the data frame, and compare that to the GDP given.</p>
<p>We find the % difference between the calculated GDP and the given GDP figures included in the dataframe</p>
<pre class="r"><code>#Recalculating GDP

tidy_GDP_data</code></pre>
<pre><code>## # A tibble: 176,880 x 5
##    CountryID Country     IndicatorName Year  Expenditure
##        &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt;       &lt;dbl&gt;
##  1         4 Afghanistan FCI           1970         5.56
##  2         4 Afghanistan FCI           1971         5.33
##  3         4 Afghanistan FCI           1972         5.20
##  4         4 Afghanistan FCI           1973         5.75
##  5         4 Afghanistan FCI           1974         6.15
##  6         4 Afghanistan FCI           1975         6.32
##  7         4 Afghanistan FCI           1976         6.37
##  8         4 Afghanistan FCI           1977         6.90
##  9         4 Afghanistan FCI           1978         7.09
## 10         4 Afghanistan FCI           1979         6.92
## # … with 176,870 more rows</code></pre>
<pre class="r"><code>#define new dataframe
tidy_GDP_data3 &lt;- tidy_GDP_data %&gt;%
  
  #select relevanr columns
  select(Country, Year, IndicatorName, Expenditure) %&gt;%
  
  #group by year and country
  group_by(Year, Country) %&gt;%
  
  #filter IndicatorName for the relevant indicators
  filter(IndicatorName %in% c(&quot;Exports&quot;,
                            &quot;Imports&quot;,
                            &quot;Gross capital formation&quot;,
                            &quot;Government Expenditure&quot;,
                            &quot;Household Expenditure&quot;,
                            &quot;GDP&quot;)) %&gt;%
  
  #summarise to generate two new columns:

  
  summarise(
    #First, we calculate the GDP as per the equation. 
      #We sum over expenditures that are NOT (Imports or GDP), for a given year and country
      #We then subtract the Imports for that same year and country.
      #This gives us the GDP for that country in that year, as per the equation
    GDP_calc = sum(Expenditure[!(IndicatorName %in% c(&quot;Imports&quot;, &quot;GDP&quot;))]) - Expenditure[IndicatorName == &quot;Imports&quot;],
    
    #Second, we generate a column with the previously given GDP
    GDP = Expenditure[IndicatorName == &quot;GDP&quot;]
    ) %&gt;% 
  
  #generate a new column with the percentage difference.
  #Note: we divide by the average of GDP and GDP_calc in the denominator as we believe this is the more correct formula to use (as opposed to just dividing by GDP_calc or GDP).
  #See the following link: https://www.mathsisfun.com/percentage-difference.html
  #It is unclear which of the two values is better suited to be the benchmark.
  #Thus, it is more mathematically rigorous to take the average of the two.
  mutate(perc_diff = (GDP - GDP_calc)/((GDP_calc+GDP)/2)) %&gt;% 
  
  
  #arrange it for neatness
  arrange(GDP_calc)

#print tidy_GDP_data3
tidy_GDP_data3</code></pre>
<pre><code>## # A tibble: 10,464 x 5
## # Groups:   Year, Country [10,464]
##    Year  Country         GDP_calc   GDP perc_diff
##    &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
##  1 1988  D.P.R. of Korea   -0.955  16.8      2.24
##  2 2001  D.P.R. of Korea   -0.836  12.8      2.28
##  3 2016  D.P.R. of Korea   -0.787  14.9      2.22
##  4 1989  D.P.R. of Korea   -0.771  17.1      2.19
##  5 2014  D.P.R. of Korea   -0.766  14.5      2.22
##  6 2006  D.P.R. of Korea   -0.766  13.9      2.23
##  7 2017  D.P.R. of Korea   -0.759  14.4      2.22
##  8 2015  D.P.R. of Korea   -0.758  14.4      2.22
##  9 2013  D.P.R. of Korea   -0.758  14.4      2.22
## 10 2012  D.P.R. of Korea   -0.751  14.2      2.22
## # … with 10,454 more rows</code></pre>
<pre class="r"><code>tidy_GDP_data_NK &lt;- tidy_GDP_data %&gt;% 
  filter(Country == &quot;D.P.R. of Korea&quot;, 
         IndicatorName %in% c(&quot;Exports&quot;,
                            &quot;Imports&quot;,
                            &quot;Gross capital formation&quot;,
                            &quot;Government Expenditure&quot;,
                            &quot;Household Expenditure&quot;,
                            &quot;GDP&quot;)
         ) %&gt;% 
  arrange(Year)

tidy_GDP_data_NK</code></pre>
<pre><code>## # A tibble: 144 x 5
##    CountryID Country         IndicatorName Year  Expenditure
##        &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;         &lt;chr&gt;       &lt;dbl&gt;
##  1       408 D.P.R. of Korea Exports       1970        0.362
##  2       408 D.P.R. of Korea Imports       1970        0.558
##  3       408 D.P.R. of Korea GDP           1970        6.72 
##  4       408 D.P.R. of Korea Exports       1971        0.399
##  5       408 D.P.R. of Korea Imports       1971        0.616
##  6       408 D.P.R. of Korea GDP           1971        7.42 
##  7       408 D.P.R. of Korea Exports       1972        0.441
##  8       408 D.P.R. of Korea Imports       1972        0.680
##  9       408 D.P.R. of Korea GDP           1972        8.19 
## 10       408 D.P.R. of Korea Exports       1973        0.486
## # … with 134 more rows</code></pre>
<p>The first thing that pops out when inspecting the data frame is that D.P.R. of Korea seems to have negative GDP according to our calculation! Upon further inspection, as can be seen in the second dataframe produced, we can see that not all the data we need to calculate the GDP using the formula is available to us for D.P.R. of Korea. This explains the strange numbers we found.</p>
<p>For the rest of the countries and years, it seems some percentage differences are small and almost negligible, others take values between 1-10% difference, and few take values greater than that. In general, the differences between the different percentages varies significantly from country to country and from year to year.</p>
<p>Finally, we would produce the following plot:</p>
<pre class="r"><code>tidy_GDP_data_prop &lt;- tidy_GDP_data %&gt;%
  
  #select relevanr columns
  select(Country, Year, IndicatorName, Expenditure) %&gt;%
  
  #filter Countries and IndicatorName for the relevant values
  filter(
    Country %in% c(&quot;Germany&quot;, 
                   &quot;India&quot;, 
                   &quot;United States&quot;),
    IndicatorName %in% c(&quot;Exports&quot;,
                         &quot;Imports&quot;,
                         &quot;Gross capital formation&quot;,
                         &quot;Government Expenditure&quot;,
                         &quot;Household Expenditure&quot;,
                         &quot;GDP&quot;)
    ) 

#pivot_wider
wider_GDP_data &lt;- pivot_wider(tidy_GDP_data_prop, names_from = IndicatorName, values_from = Expenditure) 


#add Net_Exports and GDP_cal (calculated GDP) columns
wider_GDP_data_prepped &lt;- wider_GDP_data %&gt;% 
  mutate(
    `Net Exports` = Exports - Imports, 
    GDP_cal = `Net Exports` + `Gross capital formation` + `Household Expenditure` + `Government Expenditure`,
         )

#put the table back into pivot_longer format, to prep it for graphing
longer_GDP_data &lt;- pivot_longer(wider_GDP_data_prepped, 
             !(Year | Country), 
             names_to = &quot;IndicatorName&quot;, 
             values_to = &quot;Expenditure&quot;
             )

#finalise the table by adding a proportion (prop) column, for the prop of a given indicator w.r.t calculated GDP 
#we use calculated GDP, as these numbers must be proportions (i.e. all proportions must sum to 1)
#this would not necessarily be the case using the given GDP values
longer_GDP_data_prepped &lt;- longer_GDP_data %&gt;% 
  arrange(Year) %&gt;% 
  group_by(Year, Country) %&gt;%
  mutate(prop = Expenditure/Expenditure[IndicatorName == &quot;GDP_cal&quot;]) %&gt;% 
  filter(!(IndicatorName %in%  c(&quot;Exports&quot;, &quot;Imports&quot;, &quot;GDP&quot;, &quot;GDP_cal&quot;)))

#print the prepped table
longer_GDP_data_prepped</code></pre>
<pre><code>## # A tibble: 576 x 5
## # Groups:   Year, Country [144]
##    Country       Year  IndicatorName           Expenditure     prop
##    &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;                         &lt;dbl&gt;    &lt;dbl&gt;
##  1 Germany       1970  Household Expenditure       872.     0.552  
##  2 Germany       1970  Government Expenditure      280.     0.177  
##  3 Germany       1970  Gross capital formation     442.     0.280  
##  4 Germany       1970  Net Exports                 -13.5   -0.00857
##  5 India         1970  Household Expenditure       153.     0.717  
##  6 India         1970  Government Expenditure       18.7    0.0875 
##  7 India         1970  Gross capital formation      42.2    0.198  
##  8 India         1970  Net Exports                  -0.513 -0.00241
##  9 United States 1970  Household Expenditure      2994.     0.602  
## 10 United States 1970  Government Expenditure     1256.     0.252  
## # … with 566 more rows</code></pre>
<pre class="r"><code>#plot the graph
ggplot(longer_GDP_data_prepped, 
        aes (x = Year, 
             y = prop*100, 
             color = IndicatorName, 
             group = IndicatorName)
        ) + 
  
  #line plot
  geom_line()+
  
  #labels  
  labs( title = &quot;GDP and its breakdown&quot;,
        subtitle = &quot;In Constant USD 2010&quot;, 
        x =&quot;&quot;,
        y = &quot;Proportion (% of GDP)&quot;,
        legend = &quot;&quot;
        ) +
  
  #facet_wrap it
  facet_wrap(~ Country) +
  
  #set the x-axis ticks manually
  scale_x_discrete(breaks = c(1970,1980,1990,2000,2010,2020)) +
  
  #our trusty theme wsj
  theme_wsj() +
  
  #customise our graph
  theme(
    panel.spacing = unit(3, &quot;lines&quot;),
    plot.title = element_text(size = 18),
    plot.subtitle = element_text(size=13),
    axis.title.y=element_text(size=13),
    axis.text.x = element_text(size = 9),
    axis.text.y = element_text(size = 10),
    plot.caption = element_text(size = 10),
    legend.title = element_blank(),
    legend.position = &quot;bottom&quot;,
    strip.text = element_text(size=15)
    ) </code></pre>
<p><img src="/Projects/2020-10-20-project-3_files/figure-html/unnamed-chunk-1-1.png" width="1152" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#In case you were curious, here is the code I used before you told me about pivot_wider 

# tidy_GDP_data_prop &lt;- tidy_GDP_data %&gt;%
#   
#   #select relevanr columns
#   select(Country, Year, IndicatorName, Expenditure) %&gt;%
#   
#   #filter IndicatorName for the relevant indicators
#   filter(
#     Country %in% c(&quot;Germany&quot;, 
#                    &quot;India&quot;, 
#                    &quot;United States&quot;),
#     IndicatorName %in% c(&quot;Exports&quot;,
#                          &quot;Imports&quot;,
#                          &quot;Gross capital formation&quot;,
#                          &quot;Government Expenditure&quot;,
#                          &quot;Household Expenditure&quot;,
#                          &quot;GDP&quot;)
#     ) %&gt;%
#   mutate(IndicatorName = as.factor(IndicatorName))
#   
# pivot_wider(tidy_GDP_data_prop, names_from = IndicatorName, values_from = Expenditure)
# 
# #SPLITTING TABLE
# split_table&lt;-split(tidy_GDP_data_prop, f = tidy_GDP_data_prop$IndicatorName)
# 
# #GETTING NET EXPORTS DATAFRAME
# Net_Exports &lt;- split_table$Exports$Expenditure - split_table$Imports$Expenditure
# 
# split_table$Exports &lt;- split_table$Exports %&gt;% 
#   mutate(Expenditure = Net_Exports, 
#          IndicatorName = case_when(IndicatorName == &quot;Exports&quot; ~ &quot;Net Exports&quot;),
#          ) %&gt;% 
#   mutate(IndicatorName = as.factor(IndicatorName))
# 
# #REPLACING GDP DATAFRAME BY GDP_CALC DATAFRAME
# 
# tidy_GDP_data3_relevant_countries &lt;- tidy_GDP_data3 %&gt;%
#   ungroup() %&gt;% 
#   filter(Country %in% c(&quot;Germany&quot;, 
#                    &quot;India&quot;, 
#                    &quot;United States&quot;)) %&gt;% 
#   arrange(Country)
# # 
# # tidy_GDP_data3_relevant_countries
# # split_table$GDP
# 
# split_table$GDP &lt;- split_table$GDP %&gt;% 
#   mutate(Expenditure = tidy_GDP_data3_relevant_countries$GDP_calc) 
# 
# split_table$GDP
# 
# 
# #UNSPLITTING DATAFRAME
# 
# Net_Exports_Df_extra_Imp &lt;- do.call(rbind, split_table)
# 
# 
# Net_Exports_Df &lt;- Net_Exports_Df_extra_Imp %&gt;% 
#   filter(IndicatorName != &quot;Imports&quot;) 
#   
# Net_Exports_Df
# 
# #GETTING PROPORTIONS
# 
# Net_Exports_Df_prop &lt;- Net_Exports_Df %&gt;% 
#   arrange(Country) %&gt;% 
#   group_by(Year, Country) %&gt;%
#   mutate(prop = Expenditure/Expenditure[IndicatorName == &quot;GDP&quot;]) %&gt;% 
#   filter(IndicatorName != &quot;GDP&quot;)
#     
# Net_Exports_Df_prop
# 
# 
# #PLOTTING THE GRAPH
# 
# ggplot(Net_Exports_Df_prop, 
#         aes (x = Year, 
#              y = prop*100, 
#              color = IndicatorName, 
#              group = IndicatorName)
#         ) + 
#   geom_line()+
#   labs( title = &quot;GDP and its breakdown&quot;,
#         subtitle = &quot;In Constant USD 2010&quot;, 
#         x =&quot;&quot;,
#         y = &quot;Proportion (% of GDP)&quot;
#         ) +
#   facet_wrap(~ Country) +
#   scale_x_discrete(breaks = c(1970,1980,1990,2000,2010,2020)) +
#   guides(color=guide_legend(&quot;Components of GDP&quot;)) +
#   theme_wsj() +
#     #customise our graph
#   theme(
#     panel.spacing = unit(3, &quot;lines&quot;),
#     plot.title = element_text(size = 18),
#     plot.subtitle = element_text(size=13),
#     axis.title.y=element_text(size=13),
#     axis.text.x = element_text(size = 9),
#     axis.text.y = element_text(size = 10),
#     plot.caption = element_text(size = 10),
#     legend.position = &quot;none&quot;,
#     strip.text = element_text(size=15)
#     ) </code></pre>
<p><strong>What is this last chart telling you? Can you explain in a couple of paragraphs the different dynamic among these three countries? </strong></p>
<p>The last chart breaks down the GDP of Germany, India, and the United States. It maps how much Government Expenditure, Gross Capital Formation, Net Exports, and Household Expenditure have contributed to total GDP over the years.</p>
<p>For Germany, their Household expenditure has dipped in its contribution to aggregate GDP as has Gross Capital Formation. Their Government Expenditure has stayed relatively the same in terms of contribution. However, Net Exports has increased signficantly. The increase can primarily be seen beginninng in the 1990s into the 2000s. I believe a plausible explanation for this is the end of the Soviet Union and the reunification between East and West Germany. As the economy moved away from communism and opened up economic borders, the economy opened up and the country’s net exports increased significantly.</p>
<p>For India, Household Expenditure has decreased its contribution into GDP significantly, while Government Expenditure and Net Exports (for the most part) have stayed the same. Over the past 20 years, Gross Capital Formation has heavily increased its contribution to aggregate GDP.I think a plausible explanation for this trend can be seen through the economic policies of the government. In the 1970s and 1980s, the government of India’s economic policies were not favoured towards trading or pursuing foreign relations (influenced by close relations with the Soviet Union). Since the 1990s into the 2000s, the government has ditched those past policies in favour of more open borders, trade agreements, and globalisation. This has resulted in a boom of foreign investment into the region (“oursourcing”) as well as better domestic business growth, which is seen through gross capital formation’s increased contribution. For household expenditure, their overall figures might be the same, but the contribution has been coming down due to increases in the total aggregate gdp from other sources. One could also argue that their household contribution to GDP is coming down to what other countries around the world see with their GDP.</p>
<p>For the United States, Net Exports and Government Expenditure have been slowly decreasing, while Household Expenditure and Gross Capital Formation have slighty increased. I think these trends make sense given their economy’s switch away from manufacturing to a more service-oriented, which means their net exports have decreased. Further, their economy has been strong (on average) for the past 50 years and their households (again on average) some of the wealthiest in the world, which is why these two factors have continued to increase their contribution towards GDP.</p>

                        </div>
                    </section>
            <!-- Disqus Inject -->
                
            </div>
            
        <!-- Footer -->
            
                <!-- Footer -->
    <footer id="footer">
        <div class="inner">
            <ul class="icons">
                
                    <li><a href="https://github.com/kylescheps" class="icon alt fa-github" target="_blank"><span class="label">GitHub</span></a></li>
                
            </ul>
            <ul class="copyright">
                <li>&copy; Company Name</li>
                
            </ul>
        </div>
    </footer>

            
        </div>

    <!-- Scripts -->
        <!-- Scripts -->
    <!-- jQuery -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>

    

    <!-- Main JS -->
    <script src="/js/main.js"></script>

    

    

    </body>
</html>
